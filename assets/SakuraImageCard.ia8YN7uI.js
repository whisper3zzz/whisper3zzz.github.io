import{j as L,_ as U}from"./app.JCnF4OTK.js";import"./chunks/pinia.gM4CtPT_.js";import{M as E,v as K,y as W,x as m,K as u,ab as g,R as P,a8 as v,af as S,T as x,a7 as A,ac as p,an as k,ad as O,X as w,ae as T,ar as F,am as N,ao as h,al as R,S as q,G as J,H as V,a9 as Q,a6 as Z}from"./framework.hWCtYY1X.js";import"./chunks/dayjs.BdcnXKr1.js";function M(a){if(typeof a=="string")return a;if(Array.isArray(a)&&a.length>0)return a[Math.floor(Math.random()*a.length)]}function me(a){return/\.(?:mp4|webm|ogg)$/i.test(a)}const z="success",D="error",ee=Symbol("globalOptions");function te(a){let e=new Image,s=m(0),r=m(0),t=u(()=>s.value?r.value/s.value:.5625),c=setInterval(()=>{e?.width&&(clearInterval(c),s.value=e.width,r.value=e.height)},10),f=n=>{let l=document.createElement("canvas");l.width=1,l.height=1,l.setAttribute("hidden","true"),document.body.appendChild(l),l.getContext("2d")?.drawImage(n,0,0),document.body.removeChild(l)};async function y(){let n=w(a);if(n&&(e.src=n.src,!e.complete))return new Promise((l,o)=>{e.onload=()=>{f(n),V(()=>l())},e.onerror=o})}return{width:s,height:r,aspectRatio:t,loadImage:y}}function ae(a){let e=m(!1),s=new IntersectionObserver(r=>{r[0].isIntersecting&&(e.value=!0,s.disconnect())},{threshold:.2});return P(()=>{let r=w(a);r&&s.observe(r)}),q(()=>{s.disconnect()}),{watchIntersectionOnce:r=>{let t=J(e,c=>{c&&(V().then(r),t())},{immediate:!0})},isIntersected:e}}const re=["src","alt","title"],le=["alt","loading","src"],oe={key:1,class:"v-progressive-image-slot-default"};var se=E({__name:"ProgressiveImage",props:{src:{},placeholderSrc:{},fallbackSrc:{},alt:{},title:{},customClass:{},blur:{},lazyPlaceholder:{type:Boolean},delay:{},objectCover:{type:Boolean}},emits:[z,D],setup(a,{emit:e}){let s=a,r=K(ee,{}),t=W({...s,...r}),c=e,f=m(null),y=m(null),n=m(!1),l=m(!1),o=u(()=>l.value?t.fallbackSrc:t.src),{isIntersected:i,watchIntersectionOnce:I}=ae(f),{loadImage:$,aspectRatio:C,width:B}=te(y),_=u(()=>!n.value),X=u(()=>({paddingBottom:`${C.value*100}%`})),Y=u(()=>{if(!(t.objectCover||B.value===0))return{maxWidth:`${B.value}px`}}),G=u(()=>[t.customClass,{"v-progressive-image-object-cover":t.objectCover,"v-progressive-image-loading":_.value}]);function j(d){let b=0;return typeof d=="string"?b=Number.parseInt(d):typeof d=="number"&&(b=d),b}function H(){$().then(()=>{setTimeout(()=>{n.value=!0,c(z)},j(t.delay))}).catch(d=>{n.value=!0,l.value=!0,c(D,d)})}return P(()=>{t.placeholderSrc&&t.blur&&document.documentElement.style.setProperty("--progressive-image-blur",`${j(t.blur)}px`),t.src&&I(H)}),(d,b)=>(v(),g("div",{ref_key:"rootRef",ref:f,class:R(["v-progressive-image",G.value]),style:h(Y.value)},[S("div",{style:h(X.value)},[x(F,{css:!t.placeholderSrc,name:"v-progressive-image-main-fade",appear:""},{default:k(()=>[w(i)?O((v(),g("img",{key:0,ref_key:"imageRef",ref:y,class:"v-progressive-image-main",src:o.value,alt:t.alt,title:t.title},null,8,re)),[[T,n.value]]):p("v-if",!0)]),_:1},8,["css"]),t.placeholderSrc?(v(),A(F,{key:0,name:"v-progressive-image-placeholder-fade",appear:""},{default:k(()=>[_.value?(v(),g("img",{key:0,alt:t.alt,class:"v-progressive-image-placeholder",loading:t.lazyPlaceholder?"lazy":"eager",src:t.placeholderSrc},null,8,le)):p("v-if",!0)]),_:1})):p("v-if",!0),d.$slots.default?(v(),g("div",oe,[N(d.$slots,"default",{isLoading:_.value})])):p("v-if",!0)],4)],6))}});const ne={key:1,class:"absolute top-0 h-full w-full"},ie=E({__name:"SakuraImageCard",props:{src:{},to:{},alt:{},errorImg:{},scale:{default:1.2},rotate:{default:0},skewX:{default:0},skewY:{default:0},opacity:{default:1},translateX:{default:0},translateY:{default:0},transitionDuration:{default:"var(--va-transition-duration)"},transitionTimingFunction:{default:"ease"},overlay:{type:Boolean,default:!1},overlayColor:{default:"rgba(0, 0, 0, 0.5)"},overlayOpacity:{default:.5},overlayOpacityInitial:{default:0}},setup(a){const e=a,s=L(),r=m(!1),t=m(!1),c=u(()=>e.errorImg?M(e.errorImg):s.value?.notFoundImage),f=u(()=>r.value?{transform:`scale(${e.scale}) rotate(${e.rotate}deg) skew(${e.skewX}deg, ${e.skewY}deg) translate(${e.translateX}px, ${e.translateY}px)`,opacity:e.opacity,transition:`transform ${e.transitionDuration} ${e.transitionTimingFunction}, opacity ${e.transitionDuration} ${e.transitionTimingFunction}`}:{transition:`transform ${e.transitionDuration} ${e.transitionTimingFunction}, opacity ${e.transitionDuration} ${e.transitionTimingFunction}`}),y=u(()=>({opacity:r.value?e.overlayOpacity:e.overlayOpacityInitial,backgroundColor:e.overlayColor}));function n(o){const i=o.target;if(i.setAttribute("data-src",i.src),!c.value){t.value=!0;return}t.value=!1,i.src=c.value}const l=u(()=>{const o=e.src?M(e.src):"";return o&&o.includes("?random")?o.replace("?random",`?random=${Math.random()}`):o});return(o,i)=>{const I=Q("ClientOnly"),$=U;return v(),g("div",{class:"sakura-image-card relative overflow-hidden",onMouseover:i[0]||(i[0]=C=>r.value=!0),onMouseleave:i[1]||(i[1]=C=>r.value=!1)},[x($,{flex:"~",w:"full",h:"full",to:e.to||"","aria-label":"Go to Post",class:R({"cursor-default":!e.to})},{default:k(()=>[x(I,null,{default:k(()=>[l.value?O((v(),A(w(se),{key:0,"custom-class":"sakura-image-card-img","lazy-placeholder":"",src:l.value,alt:e.alt||"cover",style:h(f.value),onError:n},null,8,["src","alt","style"])),[[T,!t.value]]):p("v-if",!0)]),_:1}),O(S("div",{class:"h-full w-full bg-$sakura-color-background opacity-70",style:h(f.value),flex:"~ center"},[...i[2]||(i[2]=[S("div",{"i-fa6-solid-image":"",w:"30%",h:"30%"},null,-1)])],4),[[T,t.value||!l.value]]),a.overlay?(v(),g("div",{key:0,class:"sakura-image-card-overlay",style:h(y.value)},null,4)):p("v-if",!0),o.$slots.default?(v(),g("div",ne,[N(o.$slots,"default",{},void 0,!0)])):p("v-if",!0)]),_:3},8,["to","class"])],32)}}}),fe=Z(ie,[["__scopeId","data-v-8692e20a"]]);export{fe as _,me as i,M as r};
